<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TARAXA: Building taraxa-node</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TARAXA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc_building.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Building taraxa-node </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md28"></a>
Compile-Time Options (cmake)</h2>
<h3><a class="anchor" id="autotoc_md29"></a>
CMAKE_BUILD_TYPE=[Release/Debug/RelWithDebInfo]</h3>
<p>Specifies whether to build with or without optimization and without or with the symbol table for debugging. Unless you are specifically debugging or running tests, it is recommended to build as release.</p>
<h1><a class="anchor" id="autotoc_md30"></a>
Building on Ubuntu 22.04</h1>
<p>For Ubuntu 22.04 users, after installing the right packages with <code>apt</code> taraxa-node will build out of the box without further effort:</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Install taraxa-node dependencies:</h2>
<pre class="fragment"># Required packages
sudo apt-get install -y \
    libtool \
    autoconf \
    ccache \
    cmake \
    clang-format-14 \
    clang-tidy-14 \
    golang-go \
    python3-pip \
    # this libs are required for arm build by go part. you can skip it for amd64 build
    libzstd-dev \
    libsnappy-dev \
    rapidjson-dev \
    libgmp-dev \
    libmpfr-dev \
    libmicrohttpd-dev

# Optional. Needed to run py_test. This won't install on arm64 OS because package is missing in apt
sudo add-apt-repository ppa:ethereum/ethereum
sudo apt-get update
sudo apt install solc

# Install conan package manager
sudo python3 -m pip install conan==1.59.0

# Setup clang as default compiler either in your IDE or by env. variables"
export CC="clang-14"
export CXX="clang++-14"
</pre> <h2><a class="anchor" id="autotoc_md32"></a>
Clone the Repository</h2>
<pre class="fragment">git clone https://github.com/Taraxa-project/taraxa-node.git --branch testnet
cd taraxa-node
git submodule update --init --recursive
</pre> <h2><a class="anchor" id="autotoc_md33"></a>
Compile</h2>
<pre class="fragment"># Optional - one time action
# Create clang profile
# It is recommended to use clang because on other compilers you could face some errors
conan profile new clang --detect &amp;&amp; \
conan profile update settings.compiler=clang clang &amp;&amp; \
conan profile update settings.compiler.version=14 clang &amp;&amp; \
conan profile update settings.compiler.libcxx=libstdc++11 clang &amp;&amp; \
conan profile update env.CC=clang-14 clang &amp;&amp; \
conan profile update env.CXX=clang++-14 clang

# Export needed var for conan
export CONAN_REVISIONS_ENABLED=1

# Compile project using cmake
mkdir cmake-build
cd cmake-build
cmake -DCONAN_PROFILE=clang -DCMAKE_BUILD_TYPE=RelWithDebInfo -DTARAXA_ENABLE_LTO=OFF -DTARAXA_STATIC_BUILD=OFF ../
make -j$(nproc)
</pre> <h1><a class="anchor" id="autotoc_md34"></a>
Building on Ubuntu 20.04</h1>
<p>For Ubuntu 20.04 users, after installing the right packages with <code>apt</code> taraxa-node will build out of the box without further effort:</p>
<h2><a class="anchor" id="autotoc_md35"></a>
Install taraxa-node dependencies:</h2>
<pre class="fragment"># Required packages
sudo apt-get install -y \
    libtool \
    autoconf \
    ccache cmake gcc g++ clang-format clang-tidy cppcheck \
    libgflags-dev\
    libjsoncpp-dev \
    libjsonrpccpp-dev \
    python3-pip \
    rapidjson-dev \
    libgmp-dev \
    libmpfr-dev \
    libmicrohttpd-dev


# Install conan package manager
# &gt;= 1.36.0 version is required to work properly with clang-14
sudo python3 -m pip install conan==1.59.0

# Install cmake
# &gt;= 3.20 version is required for JSON subcommand
# Setup your IDE accordingly to use this version
sudo python3 -m pip install cmake

# Go (required)
curl -LO https://go.dev/dl/go1.18.3.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.18.3.linux-amd64.tar.gz
rm -rf go1.18.3.linux-amd64.tar.gz

# Add go to PATH
# Add these env. variables to the ~/.profile to persist go settings even after restart
export GOROOT=/usr/local/go
export GOPATH=$HOME/.go
export PATH=$GOPATH/bin:$GOROOT/bin:$PATH

# Optional
# We are using clang from llvm toolchain as default compiler as well as clang-format and clang-tidy
# It is possible to build taraxa-node also with other C++ compilers but to contribute to the official repo,
# changes must pass clang-format/clang-tidy checks for which we internally use llvm version=13
# To install llvm:
sudo su

curl -SL -o llvm.sh https://apt.llvm.org/llvm.sh &amp;&amp; \
chmod +x llvm.sh &amp;&amp; \
./llvm.sh 14 &amp;&amp; \
apt-get install -y clang-format-14 clang-tidy-14 &amp;&amp; \
rm -f llvm.sh

# Setup clang as default compiler either in your IDE or by env. variables"
export CC="clang-14"
export CXX="clang++-14"
</pre> <h2><a class="anchor" id="autotoc_md36"></a>
Clone the Repository</h2>
<pre class="fragment">git clone https://github.com/Taraxa-project/taraxa-node.git --branch testnet
cd taraxa-node
git submodule update --init --recursive
</pre> <h2><a class="anchor" id="autotoc_md37"></a>
Compile</h2>
<pre class="fragment"># Optional - one time action
# Create clang profile
# It is recommended to use clang because on other compilers you could face some errors
conan profile new clang --detect &amp;&amp; \
conan profile update settings.compiler=clang clang &amp;&amp; \
conan profile update settings.compiler.version=14 clang &amp;&amp; \
conan profile update settings.compiler.libcxx=libstdc++11 clang &amp;&amp; \
conan profile update env.CC=clang-14 clang &amp;&amp; \
conan profile update env.CXX=clang++-14 clang

# Export needed var for conan
export CONAN_REVISIONS_ENABLED=1

# Compile project using cmake
mkdir cmake-build
cd cmake-build
cmake -DCONAN_PROFILE=clang -DCMAKE_BUILD_TYPE=RelWithDebInfo -DTARAXA_ENABLE_LTO=OFF -DTARAXA_STATIC_BUILD=OFF ../
make -j$(nproc)
</pre><p> And optional: </p><pre class="fragment"># optional
make install  # defaults to /usr/local
</pre> <h1><a class="anchor" id="autotoc_md38"></a>
Building on MacOS</h1>
<h2><a class="anchor" id="autotoc_md39"></a>
Install taraxa-node dependencies:</h2>
<p>First you need to get (Brew)[<a href="https://brew.sh/">https://brew.sh/</a>] package manager. After that you need tot install dependencies with it. Clang-14 is used for compilation. </p><pre class="fragment">brew update
brew install coreutils go autoconf automake gflags git libtool llvm@14 make pkg-config cmake conan snappy zstd rapidjson gmp mpfr libmicrohttpd 
</pre> <h2><a class="anchor" id="autotoc_md40"></a>
Clone the Repository</h2>
<pre class="fragment">git clone https://github.com/Taraxa-project/taraxa-node.git --branch testnet
cd taraxa-node
git submodule update --init --recursive
</pre> <h2><a class="anchor" id="autotoc_md41"></a>
Compile</h2>
<pre class="fragment"># Optional - one time action
# It is recommended to use clang because on other compilers you could face some errors
conan profile new clang --detect &amp;&amp; \
conan profile update settings.compiler=clang clang &amp;&amp; \
conan profile update settings.compiler.version=14 clang &amp;&amp; \
conan profile update settings.compiler.compiler.cppstd=14
conan profile update settings.compiler.libcxx=libc++ clang &amp;&amp; \
conan profile update env.CC=clang clang &amp;&amp; \
conan profile update env.CXX=clang++ clang

# Export needed var for conan
export CONAN_REVISIONS_ENABLED=1

# Build project
mkdir cmake-build
cd cmake-build
cmake -DCONAN_PROFILE=clang -DCMAKE_BUILD_TYPE=RelWithDebInfo ../
make -j$(nproc)
</pre><p> And optional: </p><pre class="fragment"># optional
make install  # defaults to /usr/local
</pre> <h2><a class="anchor" id="autotoc_md42"></a>
Known issues</h2>
<h3><a class="anchor" id="autotoc_md43"></a>
Issues with conan cache</h3>
<p>Sometimes conan cache goes wrong, so you should clean it up. You could face error like: </p><div class="fragment"><div class="line">ERROR: boost/1.76.0: Error in package_info() method, line 1492</div>
<div class="line">    raise ConanException(&quot;These libraries were expected to be built, but were not built: {}&quot;.format(non_built))</div>
<div class="line">    ConanException: These libraries were expected to be built, but were not built: {&#39;boost_math_c99l&#39;, &#39;boost_json&#39;, &#39;boost_math_c99&#39;, &#39;boost_nowide&#39;, &#39;boost_math_tr1l&#39;, &#39;boost_math_tr1f&#39;, &#39;boost_math_tr1&#39;, &#39;boost_math_c99f&#39;}</div>
</div><!-- fragment --><p>It could be cleaned up with:</p>
<div class="fragment"><div class="line">rm -rf ~/.conan/data</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md44"></a>
Building on M1 Macs for x86_64 with Rosetta2</h1>
<p>You should be able to build project following default MacOS building process. But here is a guide how to build project for x86_64 arch with Rosetta2.</p>
<h2><a class="anchor" id="autotoc_md45"></a>
Install Rosetta2</h2>
<pre class="fragment">softwareupdate --install-rosetta
</pre> <h2><a class="anchor" id="autotoc_md46"></a>
Run an x86_64 session</h2>
<pre class="fragment">arch -x86_64 zsh
</pre> <h2><a class="anchor" id="autotoc_md47"></a>
Install Homebrew</h2>
<pre class="fragment">/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
</pre> <h2><a class="anchor" id="autotoc_md48"></a>
Install dependencies</h2>
<pre class="fragment">/usr/local/bin/brew install coreutils go autoconf automake gflags git libtool llvm@13 make pkg-config cmake conan snappy zstd rapidjson gmp mpfr libmicrohttpd
</pre> <h2><a class="anchor" id="autotoc_md49"></a>
Clone the Repository</h2>
<pre class="fragment">git clone https://github.com/Taraxa-project/taraxa-node.git --branch testnet
cd taraxa-node
git submodule update --init --recursive
</pre> <h2><a class="anchor" id="autotoc_md50"></a>
Compile</h2>
<pre class="fragment"># Optional - one time action
# It is recommended to use clang because on other compilers you could face some errors
# Make sure that you executing this from x86_64 CLI. Could be verified with `arch` command
# It output should be equal to `i386`
conan profile new clang --detect &amp;&amp; \
conan profile update settings.compiler=clang clang &amp;&amp; \
conan profile update settings.compiler.version=14 clang &amp;&amp; \
conan profile update settings.compiler.libcxx=libc++ clang &amp;&amp; \
conan profile update env.CC=/usr/local/opt/llvm/bin/clang clang &amp;&amp; \
conan profile update env.CXX=/usr/local/opt/llvm/bin/clang++ clang

# Export needed var for conan
export CONAN_REVISIONS_ENABLED=1

# Build project
mkdir cmake-build
cd cmake-build
# Make sure that you are specifying the full path to C and CXX compilers
cmake -DCONAN_PROFILE=clang -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=/usr/local/opt/llvm/bin/clang -DCMAKE_CXX_COMPILER=/usr/local/opt/llvm/bin/clang++ ../
make -j$(nproc)
</pre> <h1><a class="anchor" id="autotoc_md51"></a>
Run</h1>
<h2><a class="anchor" id="autotoc_md52"></a>
Running tests</h2>
<blockquote class="doxtable">
<p>OSX: maybe you need to set a new limit for max open files per thread/process: <code>ulimit -n 200000</code> </p>
</blockquote>
<p>cd cmake-build-release make all_tests</p>
<p>or</p>
<p>cd cd cmake-build-release/tests ctest</p>
<h2><a class="anchor" id="autotoc_md53"></a>
Running taraxa-node</h2>
<p>cd cmake-build-release/src/taraxad</p>
<p>Run taraxa node with default testnet config which on initial run will generate default config and wallet file in <code>~/.taraxa/config.json</code> and <code>~/.taraxa/wallet.json</code> </p><pre class="fragment"># run taraxa-node
./taraxad
</pre><p> Run taraxa node with specified config and wallet files </p><pre class="fragment"># run taraxa-node
./taraxad --config /path/to/config/file --wallet /path/to/wallet/file
</pre><p> Run help message to display all command line options to run and configure node in devnet, testnet or custom network </p><pre class="fragment"># help
./taraxad --help
</pre> <h1><a class="anchor" id="autotoc_md54"></a>
Building using "taraxa-builder" docker image</h1>
<p>TODO: tutorial How to use docker image for remote building will be added soon </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
